<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 19 ggplot2 package | Introduction to R (2021)</title>
  <meta name="description" content="Part 19 ggplot2 package | Introduction to R (2021)" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 19 ggplot2 package | Introduction to R (2021)" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 19 ggplot2 package | Introduction to R (2021)" />
  
  
  

<meta name="author" content="Sarah Bonnin" />


<meta name="date" content="2021-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plots-from-other-packages.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2</b> What is R ?</a></li>
<li class="chapter" data-level="3" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html"><i class="fa fa-check"></i><b>3</b> What is RStudio ?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#rstudio-access"><i class="fa fa-check"></i><b>3.1</b> RStudio access</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#rstudio-interface"><i class="fa fa-check"></i><b>3.2</b> RStudio interface</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#setting-up-the-folder-structure-for-the-course"><i class="fa fa-check"></i><b>3.3</b> Setting up the folder structure for the course</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="what-is-rstudio.html"><a href="what-is-rstudio.html#note-on-files-and-folders-names"><i class="fa fa-check"></i><b>3.3.1</b> Note on files and folders names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>4</b> R basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-basics.html"><a href="r-basics.html#arithmetic-operators"><i class="fa fa-check"></i><b>4.1</b> Arithmetic operators</a></li>
<li class="chapter" data-level="4.2" data-path="r-basics.html"><a href="r-basics.html#simple-calculations"><i class="fa fa-check"></i><b>4.2</b> Simple calculations</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="r-basics.html"><a href="r-basics.html#hands-on-3-5-minutes"><i class="fa fa-check"></i><b>4.2.1</b> <strong>HANDS-ON</strong> (3-5 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="r-basics.html"><a href="r-basics.html#objects-in-r"><i class="fa fa-check"></i><b>4.3</b> Objects in R</a></li>
<li class="chapter" data-level="4.4" data-path="r-basics.html"><a href="r-basics.html#assignment-operators"><i class="fa fa-check"></i><b>4.4</b> Assignment operators</a></li>
<li class="chapter" data-level="4.5" data-path="r-basics.html"><a href="r-basics.html#assigning-data-to-an-object"><i class="fa fa-check"></i><b>4.5</b> Assigning data to an object</a></li>
<li class="chapter" data-level="4.6" data-path="r-basics.html"><a href="r-basics.html#using-objects"><i class="fa fa-check"></i><b>4.6</b> Using objects</a></li>
<li class="chapter" data-level="4.7" data-path="r-basics.html"><a href="r-basics.html#names-of-objects"><i class="fa fa-check"></i><b>4.7</b> Names of objects</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="r-basics.html"><a href="r-basics.html#hands-on-3-5-minutes-1"><i class="fa fa-check"></i><b>4.7.1</b> <strong>HANDS-ON</strong> (3-5 minutes)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="paths-and-directories.html"><a href="paths-and-directories.html"><i class="fa fa-check"></i><b>5</b> Paths and directories</a>
<ul>
<li class="chapter" data-level="5.1" data-path="paths-and-directories.html"><a href="paths-and-directories.html#tree-of-directories"><i class="fa fa-check"></i><b>5.1</b> Tree of directories</a></li>
<li class="chapter" data-level="5.2" data-path="paths-and-directories.html"><a href="paths-and-directories.html#navigate-the-tree-of-directory-with-the-r-console"><i class="fa fa-check"></i><b>5.2</b> Navigate the tree of directory with the R console</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="paths-and-directories.html"><a href="paths-and-directories.html#hands-on-3-5-minutes-2"><i class="fa fa-check"></i><b>5.2.1</b> <strong>HANDS-ON</strong> (3-5 minutes)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a></li>
<li class="chapter" data-level="7" data-path="r-scripts.html"><a href="r-scripts.html"><i class="fa fa-check"></i><b>7</b> R scripts</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-scripts.html"><a href="r-scripts.html#create-and-save-a-script"><i class="fa fa-check"></i><b>7.1</b> Create and save a script</a></li>
<li class="chapter" data-level="7.2" data-path="r-scripts.html"><a href="r-scripts.html#r-syntax"><i class="fa fa-check"></i><b>7.2</b> R syntax</a></li>
<li class="chapter" data-level="7.3" data-path="r-scripts.html"><a href="r-scripts.html#rstudio-tips-in-the-console"><i class="fa fa-check"></i><b>7.3</b> RStudio tips in the console</a></li>
<li class="chapter" data-level="7.4" data-path="r-scripts.html"><a href="r-scripts.html#exercice-1.-getting-started-15-minutes"><i class="fa fa-check"></i><b>7.4</b> Exercice 1. Getting started ~ 15 minutes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>8</b> Data types</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-types.html"><a href="data-types.html#checking-data-types"><i class="fa fa-check"></i><b>8.1</b> Checking data types</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>9</b> Data structures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>9.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-vector"><i class="fa fa-check"></i><b>9.1.1</b> Creating a vector</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-structures.html"><a href="data-structures.html#vector-manipulation"><i class="fa fa-check"></i><b>9.1.2</b> Vector manipulation</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-structures.html"><a href="data-structures.html#combining-vectors"><i class="fa fa-check"></i><b>9.1.3</b> Combining vectors</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-structures.html"><a href="data-structures.html#numeric-vector-manipulation"><i class="fa fa-check"></i><b>9.1.4</b> Numeric vector manipulation</a></li>
<li class="chapter" data-level="9.1.5" data-path="data-structures.html"><a href="data-structures.html#character-vector-manipulation"><i class="fa fa-check"></i><b>9.1.5</b> Character vector manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-structures.html"><a href="data-structures.html#exercise-2.-numeric-vector-manipulation"><i class="fa fa-check"></i><b>9.2</b> Exercise 2. Numeric vector manipulation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-structures.html"><a href="data-structures.html#exercise-2a."><i class="fa fa-check"></i><b>9.2.1</b> Exercise 2a.</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-structures.html"><a href="data-structures.html#exercise-2b."><i class="fa fa-check"></i><b>9.2.2</b> Exercise 2b.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-structures.html"><a href="data-structures.html#exercise-3.-character-vector-manipulation"><i class="fa fa-check"></i><b>9.3</b> Exercise 3. Character vector manipulation</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="data-structures.html"><a href="data-structures.html#exercise-3a."><i class="fa fa-check"></i><b>9.3.1</b> Exercise 3a.</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-structures.html"><a href="data-structures.html#exercise-3b."><i class="fa fa-check"></i><b>9.3.2</b> Exercise 3b.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="data-structures.html"><a href="data-structures.html#factors"><i class="fa fa-check"></i><b>9.4</b> Factors</a></li>
<li class="chapter" data-level="9.5" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>9.5</b> Matrices</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="data-structures.html"><a href="data-structures.html#creating-a-matrix"><i class="fa fa-check"></i><b>9.5.1</b> Creating a matrix</a></li>
<li class="chapter" data-level="9.5.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-object"><i class="fa fa-check"></i><b>9.5.2</b> Two-dimensional object</a></li>
<li class="chapter" data-level="9.5.3" data-path="data-structures.html"><a href="data-structures.html#matrix-manipulation"><i class="fa fa-check"></i><b>9.5.3</b> Matrix manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>9.6</b> Data frames</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="data-structures.html"><a href="data-structures.html#create-a-data-frame"><i class="fa fa-check"></i><b>9.6.1</b> Create a data frame</a></li>
<li class="chapter" data-level="9.6.2" data-path="data-structures.html"><a href="data-structures.html#data-frame-manipulation"><i class="fa fa-check"></i><b>9.6.2</b> Data frame manipulation:</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-structures-manipulation"><i class="fa fa-check"></i><b>9.7</b> Two-dimensional structures manipulation</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="data-structures.html"><a href="data-structures.html#dimensions"><i class="fa fa-check"></i><b>9.7.1</b> Dimensions</a></li>
<li class="chapter" data-level="9.7.2" data-path="data-structures.html"><a href="data-structures.html#manipulation"><i class="fa fa-check"></i><b>9.7.2</b> Manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="data-structures.html"><a href="data-structures.html#exercise-4.-matrix-manipulation"><i class="fa fa-check"></i><b>9.8</b> Exercise 4. Matrix manipulation</a></li>
<li class="chapter" data-level="9.9" data-path="data-structures.html"><a href="data-structures.html#exercise-5.-data-frame-manipulation"><i class="fa fa-check"></i><b>9.9</b> Exercise 5. Data frame manipulation</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="data-structures.html"><a href="data-structures.html#exercise-5a"><i class="fa fa-check"></i><b>9.9.1</b> Exercise 5a</a></li>
<li class="chapter" data-level="9.9.2" data-path="data-structures.html"><a href="data-structures.html#exercise-5b"><i class="fa fa-check"></i><b>9.9.2</b> Exercise 5b</a></li>
<li class="chapter" data-level="9.9.3" data-path="data-structures.html"><a href="data-structures.html#exercise-5c"><i class="fa fa-check"></i><b>9.9.3</b> Exercise 5c</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>10</b> Missing values</a></li>
<li class="chapter" data-level="11" data-path="input-output.html"><a href="input-output.html"><i class="fa fa-check"></i><b>11</b> Input / Output</a>
<ul>
<li class="chapter" data-level="11.1" data-path="input-output.html"><a href="input-output.html#on-vectors"><i class="fa fa-check"></i><b>11.1</b> On vectors</a></li>
<li class="chapter" data-level="11.2" data-path="input-output.html"><a href="input-output.html#on-data-frames-or-matrices"><i class="fa fa-check"></i><b>11.2</b> On data frames or matrices</a></li>
<li class="chapter" data-level="11.3" data-path="input-output.html"><a href="input-output.html#exercise-6."><i class="fa fa-check"></i><b>11.3</b> Exercise 6.</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="input-output.html"><a href="input-output.html#exercise-6a.-input-output"><i class="fa fa-check"></i><b>11.3.1</b> Exercise 6a. Input / output</a></li>
<li class="chapter" data-level="11.3.2" data-path="input-output.html"><a href="input-output.html#exercise-6b---io-on-data-frames-play-with-the-arguments-of-read.table"><i class="fa fa-check"></i><b>11.3.2</b> Exercise 6b - I/O on data frames: play with the arguments of read.table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="library-and-packages.html"><a href="library-and-packages.html"><i class="fa fa-check"></i><b>12</b> Library and packages</a>
<ul>
<li class="chapter" data-level="12.1" data-path="library-and-packages.html"><a href="library-and-packages.html#r-base"><i class="fa fa-check"></i><b>12.1</b> R base</a></li>
<li class="chapter" data-level="12.2" data-path="library-and-packages.html"><a href="library-and-packages.html#r-contrib"><i class="fa fa-check"></i><b>12.2</b> R contrib</a></li>
<li class="chapter" data-level="12.3" data-path="library-and-packages.html"><a href="library-and-packages.html#install-a-package"><i class="fa fa-check"></i><b>12.3</b> Install a package</a></li>
<li class="chapter" data-level="12.4" data-path="library-and-packages.html"><a href="library-and-packages.html#load-a-package"><i class="fa fa-check"></i><b>12.4</b> Load a package</a></li>
<li class="chapter" data-level="12.5" data-path="library-and-packages.html"><a href="library-and-packages.html#check-what-packages-are-currently-loaded"><i class="fa fa-check"></i><b>12.5</b> Check what packages are currently loaded</a></li>
<li class="chapter" data-level="12.6" data-path="library-and-packages.html"><a href="library-and-packages.html#list-functions-from-a-package"><i class="fa fa-check"></i><b>12.6</b> List functions from a package</a></li>
<li class="chapter" data-level="12.7" data-path="library-and-packages.html"><a href="library-and-packages.html#rstudio-server-at-crg"><i class="fa fa-check"></i><b>12.7</b> RStudio server at CRG</a></li>
<li class="chapter" data-level="12.8" data-path="library-and-packages.html"><a href="library-and-packages.html#exercise-7-library-and-packages"><i class="fa fa-check"></i><b>12.8</b> Exercise 7: Library and packages</a></li>
<li class="chapter" data-level="12.9" data-path="library-and-packages.html"><a href="library-and-packages.html#exercise-to-do-at-home"><i class="fa fa-check"></i><b>12.9</b> Exercise (to do at home)</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>13</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="regular-expressions.html"><a href="regular-expressions.html#find-simple-matches-with-grep"><i class="fa fa-check"></i><b>13.1</b> Find simple matches with grep</a></li>
<li class="chapter" data-level="13.2" data-path="regular-expressions.html"><a href="regular-expressions.html#regular-expressions-to-find-more-flexible-patterns"><i class="fa fa-check"></i><b>13.2</b> Regular expressions to find more flexible patterns</a></li>
<li class="chapter" data-level="13.3" data-path="regular-expressions.html"><a href="regular-expressions.html#substitute-or-remove-matching-patterns-with-gsub"><i class="fa fa-check"></i><b>13.3</b> Substitute or remove matching patterns with gsub</a></li>
<li class="chapter" data-level="13.4" data-path="regular-expressions.html"><a href="regular-expressions.html#predefined-variables-to-use-in-regular-expressions"><i class="fa fa-check"></i><b>13.4</b> Predefined variables to use in regular expressions:</a></li>
<li class="chapter" data-level="13.5" data-path="regular-expressions.html"><a href="regular-expressions.html#use-grep-and-regular-expressions-to-retrieve-columns-by-their-names"><i class="fa fa-check"></i><b>13.5</b> Use grep and regular expressions to retrieve columns by their names</a></li>
<li class="chapter" data-level="13.6" data-path="regular-expressions.html"><a href="regular-expressions.html#exercise-8-regular-expressions"><i class="fa fa-check"></i><b>13.6</b> Exercise 8: Regular expressions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="conditional-statement.html"><a href="conditional-statement.html"><i class="fa fa-check"></i><b>14</b> Conditional statement</a>
<ul>
<li class="chapter" data-level="14.1" data-path="conditional-statement.html"><a href="conditional-statement.html#exercise-9-if-statement"><i class="fa fa-check"></i><b>14.1</b> Exercise 9: If statement</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="repetitive-execution.html"><a href="repetitive-execution.html"><i class="fa fa-check"></i><b>15</b> Repetitive execution</a>
<ul>
<li class="chapter" data-level="15.1" data-path="repetitive-execution.html"><a href="repetitive-execution.html#exercise-10-for-loop"><i class="fa fa-check"></i><b>15.1</b> Exercise 10: For loop</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="base-plots-in-r.html"><a href="base-plots-in-r.html"><i class="fa fa-check"></i><b>16</b> “Base” plots in R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="base-plots-in-r.html"><a href="base-plots-in-r.html#scatter-plots"><i class="fa fa-check"></i><b>16.1</b> Scatter plots</a></li>
<li class="chapter" data-level="16.2" data-path="base-plots-in-r.html"><a href="base-plots-in-r.html#bar-plots"><i class="fa fa-check"></i><b>16.2</b> Bar plots</a></li>
<li class="chapter" data-level="16.3" data-path="base-plots-in-r.html"><a href="base-plots-in-r.html#pie-charts"><i class="fa fa-check"></i><b>16.3</b> Pie charts</a></li>
<li class="chapter" data-level="16.4" data-path="base-plots-in-r.html"><a href="base-plots-in-r.html#box-plots"><i class="fa fa-check"></i><b>16.4</b> Box plots</a></li>
<li class="chapter" data-level="16.5" data-path="base-plots-in-r.html"><a href="base-plots-in-r.html#histograms"><i class="fa fa-check"></i><b>16.5</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html"><i class="fa fa-check"></i><b>17</b> How to save plots</a>
<ul>
<li class="chapter" data-level="17.1" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#with-r-studio"><i class="fa fa-check"></i><b>17.1</b> With R Studio</a></li>
<li class="chapter" data-level="17.2" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#with-the-console"><i class="fa fa-check"></i><b>17.2</b> With the console</a></li>
<li class="chapter" data-level="17.3" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11-base-plots"><i class="fa fa-check"></i><b>17.3</b> Exercise 11: Base plots</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11a--scatter-plot"><i class="fa fa-check"></i><b>17.3.1</b> Exercise 11a- scatter plot</a></li>
<li class="chapter" data-level="17.3.2" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11b--bar-plot-pie-chart"><i class="fa fa-check"></i><b>17.3.2</b> Exercise 11b- bar plot + pie chart</a></li>
<li class="chapter" data-level="17.3.3" data-path="how-to-save-plots.html"><a href="how-to-save-plots.html#exercise-11c--histogram"><i class="fa fa-check"></i><b>17.3.3</b> Exercise 11c- histogram</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html"><i class="fa fa-check"></i><b>18</b> Plots from other packages</a>
<ul>
<li class="chapter" data-level="18.1" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#heatmap.2-function-from-gplots-package"><i class="fa fa-check"></i><b>18.1</b> heatmap.2 function from gplots package</a></li>
<li class="chapter" data-level="18.2" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#pheatmap-function-from-the-pheatmap-package"><i class="fa fa-check"></i><b>18.2</b> pheatmap function from the pheatmap package</a></li>
<li class="chapter" data-level="18.3" data-path="plots-from-other-packages.html"><a href="plots-from-other-packages.html#venn.diagram-function-from-venndiagram-package"><i class="fa fa-check"></i><b>18.3</b> venn.diagram function from VennDiagram package</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ggplot2-package.html"><a href="ggplot2-package.html"><i class="fa fa-check"></i><b>19</b> ggplot2 package</a>
<ul>
<li class="chapter" data-level="19.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#getting-started"><i class="fa fa-check"></i><b>19.1</b> Getting started</a></li>
<li class="chapter" data-level="19.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scatter-plot"><i class="fa fa-check"></i><b>19.2</b> Scatter plot</a></li>
<li class="chapter" data-level="19.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#box-plots-1"><i class="fa fa-check"></i><b>19.3</b> Box plots</a></li>
<li class="chapter" data-level="19.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#dot-plots"><i class="fa fa-check"></i><b>19.4</b> Dot plots</a></li>
<li class="chapter" data-level="19.5" data-path="ggplot2-package.html"><a href="ggplot2-package.html#bar-plots-1"><i class="fa fa-check"></i><b>19.5</b> Bar plots</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#bar-plots-with-error-bars"><i class="fa fa-check"></i><b>19.5.1</b> Bar plots with error bars</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="ggplot2-package.html"><a href="ggplot2-package.html#histograms-1"><i class="fa fa-check"></i><b>19.6</b> Histograms</a></li>
<li class="chapter" data-level="19.7" data-path="ggplot2-package.html"><a href="ggplot2-package.html#about-themes"><i class="fa fa-check"></i><b>19.7</b> About themes</a></li>
<li class="chapter" data-level="19.8" data-path="ggplot2-package.html"><a href="ggplot2-package.html#saving-plots-in-files"><i class="fa fa-check"></i><b>19.8</b> Saving plots in files</a></li>
<li class="chapter" data-level="19.9" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12-ggplot2"><i class="fa fa-check"></i><b>19.9</b> Exercise 12: ggplot2</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12a--scatter-plot"><i class="fa fa-check"></i><b>19.9.1</b> Exercise 12a- Scatter plot</a></li>
<li class="chapter" data-level="19.9.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12b--box-plot"><i class="fa fa-check"></i><b>19.9.2</b> Exercise 12b- Box plot</a></li>
<li class="chapter" data-level="19.9.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12c--bar-plot"><i class="fa fa-check"></i><b>19.9.3</b> Exercise 12c- Bar plot</a></li>
<li class="chapter" data-level="19.9.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#exercise-12d--histogram"><i class="fa fa-check"></i><b>19.9.4</b> Exercise 12d- Histogram</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="ggplot2-package.html"><a href="ggplot2-package.html#more-about-the-theme-function"><i class="fa fa-check"></i><b>19.10</b> More about the theme() function</a></li>
<li class="chapter" data-level="19.11" data-path="ggplot2-package.html"><a href="ggplot2-package.html#volcano-plots"><i class="fa fa-check"></i><b>19.11</b> Volcano plots</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R (2021)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2-package" class="section level1" number="19">
<h1><span class="header-section-number">Part 19</span> ggplot2 package</h1>
<ul>
<li><p>Graphing package inspired by the <strong>G</strong>rammar of <strong>G</strong>raphics work of Leland Wilkinson.</p></li>
<li><p>A tool that enables to concisely describe the components of a graphic.</p></li>
<li><p>Why ggplot2 ?</p>
<ul>
<li>Flexible</li>
<li>Customizable</li>
<li>Pretty !</li>
<li>Well documented</li>
</ul></li>
<li><p>We will see:</p>
<ul>
<li>Scatter plots</li>
<li>Box plots</li>
<li>Dot plots</li>
<li>Bar plots</li>
<li>Histograms</li>
<li>How to save plots</li>
<li>Volcano plots</li>
</ul></li>
</ul>
<div id="getting-started" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Getting started</h2>
<p>Load package:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="ggplot2-package.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<ul>
<li>All ggplots start with a <strong>base layer</strong> created with the <strong>ggplot()</strong> function:</li>
</ul>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="ggplot2-package.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dataframe, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>column1, <span class="at">y=</span>column2))</span></code></pre></div>
<p><em>The base layer is setting the grounds but NOT plotting anything:</em></p>
<ul>
<li>You then add a layer (with the <strong>+</strong> sign) that describes what kind of plot you want:
<ul>
<li>geom_point()</li>
<li>geom_bar()</li>
<li>geom_histogram()</li>
<li>geom_boxplot()</li>
<li>…</li>
</ul></li>
<li>And then you will add <strong>one layer at a time</strong> to add more features to your plot!</li>
</ul>
</div>
<div id="scatter-plot" class="section level2" number="19.2">
<h2><span class="header-section-number">19.2</span> Scatter plot</h2>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="ggplot2-package.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of a scatter plot: add the geom_point() layer</span></span>
<span id="cb412-2"><a href="ggplot2-package.html#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dataframe, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>column1, <span class="at">y=</span>column2)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<ul>
<li>Example of a simple scatter plot:</li>
</ul>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="ggplot2-package.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb413-2"><a href="ggplot2-package.html#cb413-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample1=</span><span class="fu">rnorm</span>(<span class="dv">200</span>), <span class="at">sample2=</span><span class="fu">rnorm</span>(<span class="dv">200</span>))</span>
<span id="cb413-3"><a href="ggplot2-package.html#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="ggplot2-package.html#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot !</span></span>
<span id="cb413-5"><a href="ggplot2-package.html#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> df1 , <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sample1, <span class="at">y=</span>sample2)) <span class="sc">+</span> </span>
<span id="cb413-6"><a href="ggplot2-package.html#cb413-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
<ul>
<li>Add <strong>layers</strong> to that object to customize the plot:
<ul>
<li><strong>ggtitle</strong> to add a title</li>
<li><strong>geom_vline</strong> to add a vertical line</li>
<li>etc.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="ggplot2-package.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span> df1 , <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sample1, <span class="at">y=</span>sample2)) <span class="sc">+</span> </span>
<span id="cb414-2"><a href="ggplot2-package.html#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb414-3"><a href="ggplot2-package.html#cb414-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="at">label=</span><span class="st">&quot;my first ggplot&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-4"><a href="ggplot2-package.html#cb414-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-322-1.png" width="672" /></p>
<p>Bookmark that <a href="https://ggplot2.tidyverse.org/reference/">ggplot2 reference</a> and that good <a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf">cheatsheet</a> for some of the ggplot2 options.</p>
<ul>
<li>You can save the plot in an object <strong>at any time</strong> and add layers to that object:</li>
</ul>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="ggplot2-package.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save in an object</span></span>
<span id="cb415-2"><a href="ggplot2-package.html#cb415-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span> df1 , <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sample1, <span class="at">y=</span>sample2)) <span class="sc">+</span></span>
<span id="cb415-3"><a href="ggplot2-package.html#cb415-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb415-4"><a href="ggplot2-package.html#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add layers to that object</span></span>
<span id="cb415-5"><a href="ggplot2-package.html#cb415-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="at">label=</span><span class="st">&quot;my first ggplot&quot;</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
<ul>
<li>What is inside the <strong>aes</strong> (aesthetics)function ?
<ul>
<li>Anything that varies according to your data !
<ul>
<li>Columns with values to be plotted.</li>
<li>Columns with which you want to, for example, color the points.</li>
</ul></li>
</ul></li>
</ul>
<p>Color all points in red (not depending on the data):</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="ggplot2-package.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df1 , <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sample1, <span class="at">y=</span>sample2)) <span class="sc">+</span></span>
<span id="cb416-2"><a href="ggplot2-package.html#cb416-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-324-1.png" width="672" /></p>
<p>Color the points according to another column in the data frame:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="ggplot2-package.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a data frame from df1: add a column with &quot;yes&quot; and &quot;no&quot;</span></span>
<span id="cb417-2"><a href="ggplot2-package.html#cb417-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df1, <span class="at">grouping=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">120</span>)))</span>
<span id="cb417-3"><a href="ggplot2-package.html#cb417-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-4"><a href="ggplot2-package.html#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot and add the color parameter in the aes():</span></span>
<span id="cb417-5"><a href="ggplot2-package.html#cb417-5" aria-hidden="true" tabindex="-1"></a>pscat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df2, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sample1, <span class="at">y=</span>sample2, <span class="at">color=</span>grouping)) <span class="sc">+</span> </span>
<span id="cb417-6"><a href="ggplot2-package.html#cb417-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb417-7"><a href="ggplot2-package.html#cb417-7" aria-hidden="true" tabindex="-1"></a>pscat</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
</div>
<div id="box-plots-1" class="section level2" number="19.3">
<h2><span class="header-section-number">19.3</span> Box plots</h2>
<ul>
<li>Simple boxplot showing the data distribution of sample 1:</li>
</ul>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="ggplot2-package.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df2, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span>sample1)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-326-1.png" width="672" /></p>
<ul>
<li>Split the data into 2 boxes:</li>
</ul>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="ggplot2-package.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df2, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>grouping, <span class="at">y=</span>sample1)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-327-1.png" width="672" /></p>
<ul>
<li>What if you want to plot both sample1 and sample2 ?<br>
<em>You need to convert into a <strong>long</strong> format</em>
<br></li>
</ul>
<p>What is the <strong>long</strong> format ?</p>
<p><img src="images/plots/wide2long.png" width="800"></p>
<p>Plotting both sample1 and sample2:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="ggplot2-package.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install package reshape2</span></span>
<span id="cb420-2"><a href="ggplot2-package.html#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;reshape2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="ggplot2-package.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb421-2"><a href="ggplot2-package.html#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;reshape2&quot;</span>)</span>
<span id="cb421-3"><a href="ggplot2-package.html#cb421-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-4"><a href="ggplot2-package.html#cb421-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to long format</span></span>
<span id="cb421-5"><a href="ggplot2-package.html#cb421-5" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="at">data=</span>df2)</span>
<span id="cb421-6"><a href="ggplot2-package.html#cb421-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># all numeric values are organized into only one column: value</span></span>
<span id="cb421-7"><a href="ggplot2-package.html#cb421-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot:</span></span>
<span id="cb421-8"><a href="ggplot2-package.html#cb421-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb421-9"><a href="ggplot2-package.html#cb421-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-329-1.png" width="672" /></p>
<ul>
<li>What if now you also want to see the distribution of “yes” and “no” in both sample1 and sample2 ?<br>
<em>Integrate a parameter to the <strong>aes()</strong></em></li>
</ul>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="ggplot2-package.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Either color (color of the box border)</span></span>
<span id="cb422-2"><a href="ggplot2-package.html#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">color=</span>grouping)) <span class="sc">+</span> </span>
<span id="cb422-3"><a href="ggplot2-package.html#cb422-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="ggplot2-package.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or fill (color inside the box)</span></span>
<span id="cb423-2"><a href="ggplot2-package.html#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">fill=</span>grouping)) <span class="sc">+</span> </span>
<span id="cb423-3"><a href="ggplot2-package.html#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-331-1.png" width="672" /></p>
<p>Do you want to change the default colors?<br></p>
<ul>
<li>Integrate either layer:
<ul>
<li><strong>scale_color_manual()</strong> for the boxes border color</li>
<li><strong>scale_fill_manual()</strong> for the boxes color (inside)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="ggplot2-package.html#cb424-1" aria-hidden="true" tabindex="-1"></a>pbox_fill <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">fill=</span>grouping)) <span class="sc">+</span> </span>
<span id="cb424-2"><a href="ggplot2-package.html#cb424-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb424-3"><a href="ggplot2-package.html#cb424-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;slateblue2&quot;</span>, <span class="st">&quot;chocolate&quot;</span>))</span>
<span id="cb424-4"><a href="ggplot2-package.html#cb424-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-5"><a href="ggplot2-package.html#cb424-5" aria-hidden="true" tabindex="-1"></a>pbox_fill</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-332-1.png" width="672" /></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="ggplot2-package.html#cb425-1" aria-hidden="true" tabindex="-1"></a>pbox_col <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">color=</span>grouping)) <span class="sc">+</span></span>
<span id="cb425-2"><a href="ggplot2-package.html#cb425-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb425-3"><a href="ggplot2-package.html#cb425-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;slateblue2&quot;</span>, <span class="st">&quot;chocolate&quot;</span>))</span>
<span id="cb425-4"><a href="ggplot2-package.html#cb425-4" aria-hidden="true" tabindex="-1"></a>pbox_col</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-332-2.png" width="672" /></p>
</div>
<div id="dot-plots" class="section level2" number="19.4">
<h2><span class="header-section-number">19.4</span> Dot plots</h2>
<p>Example of the expression of a gene in 6 samples: 2 experimental groups in triplicates.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="ggplot2-package.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a named vector with the expression of a gene</span></span>
<span id="cb426-2"><a href="ggplot2-package.html#cb426-2" aria-hidden="true" tabindex="-1"></a>mygene <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">8.1</span>, <span class="fl">8.2</span>, <span class="fl">8.6</span>, <span class="fl">8.7</span>, <span class="fl">9.4</span>, <span class="fl">8.5</span>)</span>
<span id="cb426-3"><a href="ggplot2-package.html#cb426-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-4"><a href="ggplot2-package.html#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the names of each element of the vector are sample names</span></span>
<span id="cb426-5"><a href="ggplot2-package.html#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mygene) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;KO1&quot;</span>, <span class="st">&quot;KO2&quot;</span>, <span class="st">&quot;KO3&quot;</span>, <span class="st">&quot;WT1&quot;</span>, <span class="st">&quot;WT2&quot;</span>, <span class="st">&quot;WT3&quot;</span>)</span>
<span id="cb426-6"><a href="ggplot2-package.html#cb426-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-7"><a href="ggplot2-package.html#cb426-7" aria-hidden="true" tabindex="-1"></a><span class="co"># transform to long format</span></span>
<span id="cb426-8"><a href="ggplot2-package.html#cb426-8" aria-hidden="true" tabindex="-1"></a>mygenelong <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="at">data=</span>mygene)</span>
<span id="cb426-9"><a href="ggplot2-package.html#cb426-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-10"><a href="ggplot2-package.html#cb426-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add new columns containing sample names and experimental groups</span></span>
<span id="cb426-11"><a href="ggplot2-package.html#cb426-11" aria-hidden="true" tabindex="-1"></a>mygenelong<span class="sc">$</span>sample_name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mygenelong)</span>
<span id="cb426-12"><a href="ggplot2-package.html#cb426-12" aria-hidden="true" tabindex="-1"></a>mygenelong<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[1-3]{1}&quot;</span>, <span class="st">&quot;&quot;</span>, mygenelong<span class="sc">$</span>sample_name)</span>
<span id="cb426-13"><a href="ggplot2-package.html#cb426-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-14"><a href="ggplot2-package.html#cb426-14" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot</span></span>
<span id="cb426-15"><a href="ggplot2-package.html#cb426-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels with &quot;label&quot; in the aes() and layer geom_text()</span></span>
<span id="cb426-16"><a href="ggplot2-package.html#cb426-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nudge_x adjust the labels horizontally</span></span>
<span id="cb426-17"><a href="ggplot2-package.html#cb426-17" aria-hidden="true" tabindex="-1"></a>pdot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mygenelong, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>value, <span class="at">col=</span>group, <span class="at">label=</span>sample_name)) <span class="sc">+</span> </span>
<span id="cb426-18"><a href="ggplot2-package.html#cb426-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb426-19"><a href="ggplot2-package.html#cb426-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_x=</span><span class="fl">0.2</span>)</span>
<span id="cb426-20"><a href="ggplot2-package.html#cb426-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-21"><a href="ggplot2-package.html#cb426-21" aria-hidden="true" tabindex="-1"></a>pdot</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-333-1.png" width="672" /></p>
<ul>
<li>Add more layers:
<ul>
<li><strong>xlab()</strong> to change the x axis label</li>
<li><strong>ylab()</strong> to change the y axis label</li>
<li><strong>theme</strong> to manage the legend</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="ggplot2-package.html#cb427-1" aria-hidden="true" tabindex="-1"></a>pdot <span class="sc">+</span>  <span class="fu">xlab</span>(<span class="at">label=</span><span class="st">&quot;Experimental group&quot;</span>) <span class="sc">+</span></span>
<span id="cb427-2"><a href="ggplot2-package.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label=</span><span class="st">&quot;Normalized expression (log2)&quot;</span>) <span class="sc">+</span></span>
<span id="cb427-3"><a href="ggplot2-package.html#cb427-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label=</span><span class="st">&quot;Expression of gene 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb427-4"><a href="ggplot2-package.html#cb427-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb427-5"><a href="ggplot2-package.html#cb427-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
</div>
<div id="bar-plots-1" class="section level2" number="19.5">
<h2><span class="header-section-number">19.5</span> Bar plots</h2>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="ggplot2-package.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A simple bar plot</span></span>
<span id="cb428-2"><a href="ggplot2-package.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df2, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>grouping)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-335-1.png" width="672" /></p>
<ul>
<li>Customize:
<ul>
<li><strong>scale_x_discrete</strong> is used to handle x-axis title and labels</li>
<li><strong>coord_flip</strong> swaps the x and y axis</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="ggplot2-package.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot in the object &quot;p&quot;</span></span>
<span id="cb429-2"><a href="ggplot2-package.html#cb429-2" aria-hidden="true" tabindex="-1"></a>pbar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df2, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>grouping, <span class="at">fill=</span>grouping)) <span class="sc">+</span> </span>
<span id="cb429-3"><a href="ggplot2-package.html#cb429-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb429-4"><a href="ggplot2-package.html#cb429-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-5"><a href="ggplot2-package.html#cb429-5" aria-hidden="true" tabindex="-1"></a>pbar</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="ggplot2-package.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change x axis label with scale_x_discrete and change order of the bars:</span></span>
<span id="cb430-2"><a href="ggplot2-package.html#cb430-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> pbar <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">name=</span><span class="st">&quot;counts of yes / no&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))</span>
<span id="cb430-3"><a href="ggplot2-package.html#cb430-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-4"><a href="ggplot2-package.html#cb430-4" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-336-2.png" width="672" /></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="ggplot2-package.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Swapping x and y axis with coord_flip():</span></span>
<span id="cb431-2"><a href="ggplot2-package.html#cb431-2" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb431-3"><a href="ggplot2-package.html#cb431-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb431-4"><a href="ggplot2-package.html#cb431-4" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-336-3.png" width="672" /></p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="ggplot2-package.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change fill</span></span>
<span id="cb432-2"><a href="ggplot2-package.html#cb432-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;cyan&quot;</span>))</span>
<span id="cb432-3"><a href="ggplot2-package.html#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="ggplot2-package.html#cb432-4" aria-hidden="true" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-336-4.png" width="672" /></p>
<div id="bar-plots-with-error-bars" class="section level3" number="19.5.1">
<h3><span class="header-section-number">19.5.1</span> Bar plots with error bars</h3>
<p>We can create error bars on barplots.
<br>
Let’s create a toy data set, that contains 7 independent qPCR measurements for 3 genes:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="ggplot2-package.html#cb433-1" aria-hidden="true" tabindex="-1"></a>pcr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Dkk1=</span><span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">18.1</span>, <span class="fl">17.8</span>, <span class="fl">17.85</span>, <span class="fl">18.6</span>, <span class="fl">12.4</span>, <span class="fl">10.7</span>),</span>
<span id="cb433-2"><a href="ggplot2-package.html#cb433-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Pten=</span><span class="fu">c</span>(<span class="fl">15.1</span>,<span class="fl">15.2</span>, <span class="fl">15.0</span>, <span class="fl">15.6</span>, <span class="fl">15.3</span>, <span class="fl">14.8</span>, <span class="fl">15.9</span>),</span>
<span id="cb433-3"><a href="ggplot2-package.html#cb433-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tp53=</span><span class="fu">c</span>(<span class="fl">9.1</span>, <span class="fl">9.9</span>, <span class="fl">9.25</span>, <span class="fl">8.7</span>, <span class="fl">8.8</span>, <span class="fl">9.3</span>, <span class="fl">7.8</span>))</span></code></pre></div>
<p>The height of the bar will represent the <strong>average</strong> qPCR measurement. The error bar will represent the <strong>average - standard deviation</strong> on the lowe part, and the <strong>average + standard deviation</strong> on the high part.
<br>
We need to create a data frame that <strong>summarizes</strong> these values:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="ggplot2-package.html#cb434-1" aria-hidden="true" tabindex="-1"></a>pcr_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">average=</span><span class="fu">apply</span>(pcr, <span class="dv">2</span>, mean), </span>
<span id="cb434-2"><a href="ggplot2-package.html#cb434-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">standard_deviation=</span><span class="fu">apply</span>(pcr, <span class="dv">2</span>, sd),</span>
<span id="cb434-3"><a href="ggplot2-package.html#cb434-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">genes=</span><span class="fu">colnames</span>(pcr))</span></code></pre></div>
<p>And now we can plot!</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="ggplot2-package.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pcr_summary, <span class="fu">aes</span>(<span class="at">x=</span>genes, <span class="at">y=</span>average, <span class="at">fill=</span>genes)) <span class="sc">+</span> </span>
<span id="cb435-2"><a href="ggplot2-package.html#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-3"><a href="ggplot2-package.html#cb435-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>average<span class="sc">-</span>standard_deviation, <span class="at">ymax=</span>average<span class="sc">+</span>standard_deviation), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">width=</span>.<span class="dv">1</span>) </span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-339-1.png" width="672" /></p>
</div>
</div>
<div id="histograms-1" class="section level2" number="19.6">
<h2><span class="header-section-number">19.6</span> Histograms</h2>
<p>Simple histogram on one sample (using the df2 data frame):</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="ggplot2-package.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df1, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sample1)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
<p>Histogram on more samples (using df_long):</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="ggplot2-package.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-341-1.png" width="672" /></p>
<p>Split the data per sample (“variable” column that represents here the samples):</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="ggplot2-package.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>variable)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
<p>By default, the histograms are <strong>stacked</strong>: change to position <strong>dodge</strong> (side by side):</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="ggplot2-package.html#cb442-1" aria-hidden="true" tabindex="-1"></a>phist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>variable)) <span class="sc">+</span> </span>
<span id="cb442-2"><a href="ggplot2-package.html#cb442-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">position=</span><span class="st">&#39;dodge&#39;</span>)</span>
<span id="cb442-3"><a href="ggplot2-package.html#cb442-3" aria-hidden="true" tabindex="-1"></a>phist</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-343-1.png" width="672" /></p>
</div>
<div id="about-themes" class="section level2" number="19.7">
<h2><span class="header-section-number">19.7</span> About themes</h2>
<p>You can change the default global <strong>theme</strong> (background color, grid lines etc. all non-data display):</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="ggplot2-package.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># go back to a previous plot</span></span>
<span id="cb444-2"><a href="ggplot2-package.html#cb444-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span>
<span id="cb444-3"><a href="ggplot2-package.html#cb444-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-4"><a href="ggplot2-package.html#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Try different themes</span></span>
<span id="cb444-5"><a href="ggplot2-package.html#cb444-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="ggplot2-package.html#cb445-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-344-2.png" width="672" /></p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="ggplot2-package.html#cb446-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-344-3.png" width="672" /></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="ggplot2-package.html#cb447-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_grey</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-344-4.png" width="672" /></p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="ggplot2-package.html#cb448-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_dark</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-344-5.png" width="672" /></p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="ggplot2-package.html#cb449-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_light</span>() </span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-344-6.png" width="672" /></p>
</div>
<div id="saving-plots-in-files" class="section level2" number="19.8">
<h2><span class="header-section-number">19.8</span> Saving plots in files</h2>
<ul>
<li>The same as for regular plots applies:</li>
</ul>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="ggplot2-package.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;myggplot.png&quot;</span>)</span>
<span id="cb450-2"><a href="ggplot2-package.html#cb450-2" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb450-3"><a href="ggplot2-package.html#cb450-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<ul>
<li>You can also use the ggplot2 <strong>ggsave</strong> function:</li>
</ul>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="ggplot2-package.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, save the last plot that was produced</span></span>
<span id="cb451-2"><a href="ggplot2-package.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;lastplot.png&quot;</span>)</span>
<span id="cb451-3"><a href="ggplot2-package.html#cb451-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-4"><a href="ggplot2-package.html#cb451-4" aria-hidden="true" tabindex="-1"></a><span class="co"># You can pick which plot you want to save:</span></span>
<span id="cb451-5"><a href="ggplot2-package.html#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;myplot.png&quot;</span>, <span class="at">plot=</span>p)</span>
<span id="cb451-6"><a href="ggplot2-package.html#cb451-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-7"><a href="ggplot2-package.html#cb451-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Many different formats are available: </span></span>
<span id="cb451-8"><a href="ggplot2-package.html#cb451-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;eps&quot;, &quot;ps&quot;, &quot;tex&quot;, &quot;pdf&quot;, &quot;jpeg&quot;, &quot;tiff&quot;, &quot;png&quot;, &quot;bmp&quot;, &quot;svg&quot;, &quot;wmf&quot;</span></span>
<span id="cb451-9"><a href="ggplot2-package.html#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;myplot.ps&quot;</span>, <span class="at">plot=</span>p, <span class="at">device=</span><span class="st">&quot;ps&quot;</span>)</span>
<span id="cb451-10"><a href="ggplot2-package.html#cb451-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-11"><a href="ggplot2-package.html#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the height and width (and their unit):</span></span>
<span id="cb451-12"><a href="ggplot2-package.html#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;myplot.pdf&quot;</span>, </span>
<span id="cb451-13"><a href="ggplot2-package.html#cb451-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">20</span>, </span>
<span id="cb451-14"><a href="ggplot2-package.html#cb451-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">20</span>, </span>
<span id="cb451-15"><a href="ggplot2-package.html#cb451-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
<ul>
<li>You can also organize several plots on one page
<ul>
<li>One way is to use the <strong>gridExtra</strong> package:</li>
<li>ncol, nrow: arrange plots in such number of columns and rows</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="ggplot2-package.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="ggplot2-package.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb453-2"><a href="ggplot2-package.html#cb453-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb453-3"><a href="ggplot2-package.html#cb453-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 rows and 2 columns</span></span>
<span id="cb453-4"><a href="ggplot2-package.html#cb453-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(pscat, pbox_fill, pbar, phist, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-348-1.png" width="672" /></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="ggplot2-package.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 row and 4 columns</span></span>
<span id="cb454-2"><a href="ggplot2-package.html#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(pscat, pbox_fill, pbar, phist, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-349-1.png" width="960" /></p>
<p>Combine ggsave and grid.arrange:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="ggplot2-package.html#cb455-1" aria-hidden="true" tabindex="-1"></a>myplots <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(pscat, pbox_fill, pbar, phist, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb455-2"><a href="ggplot2-package.html#cb455-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-3"><a href="ggplot2-package.html#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;mygridarrange.png&quot;</span>, <span class="at">plot=</span>myplots)<span class="er">)</span></span></code></pre></div>

</div>
<div id="exercise-12-ggplot2" class="section level2" number="19.9">
<h2><span class="header-section-number">19.9</span> Exercise 12: ggplot2</h2>
<p>Create the script “exercise12.R” and save it to the “Rcourse/Module3” directory: you will save all the commands of exercise 12 in that script.
<br>Remember you can comment the code using #.</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="ggplot2-package.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb456-2"><a href="ggplot2-package.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Rcourse/Module3&quot;</span>)</span></code></pre></div>
</details>
<div id="exercise-12a--scatter-plot" class="section level3" number="19.9.1">
<h3><span class="header-section-number">19.9.1</span> Exercise 12a- Scatter plot</h3>
<p><strong>1- Load ggplot2 package</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="ggplot2-package.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</details>
<p><strong>2- Download the data we will use for plotting:</strong></p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="ggplot2-package.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://raw.githubusercontent.com/biocorecrg/CRG_RIntroduction/master/ex12_normalized_intensities.csv&quot;</span>, <span class="st">&quot;ex12_normalized_intensities.csv&quot;</span>, <span class="at">method=</span><span class="st">&quot;curl&quot;</span>)</span></code></pre></div>
<p><strong>3- Read file into object “project1” (remember the input/output tutorial!)</strong></p>
<p>About this file:</p>
<ul>
<li>It is comma separated (csv format).</li>
<li>The first row is the header.</li>
<li>Take the row names from the first column.</li>
</ul>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="ggplot2-package.html#cb459-1" aria-hidden="true" tabindex="-1"></a>project1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;ex12_normalized_intensities.csv&quot;</span>, </span>
<span id="cb459-2"><a href="ggplot2-package.html#cb459-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, </span>
<span id="cb459-3"><a href="ggplot2-package.html#cb459-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb459-4"><a href="ggplot2-package.html#cb459-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span>)</span></code></pre></div>
</details>
<p><strong>4- Using ggplot, create a simple scatter plot representing gene expression of “sampleB” on the x-axis and “sampleH” on the y-axis.</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="ggplot2-package.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project1, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sampleB, <span class="at">y=</span>sampleH)) <span class="sc">+</span> </span>
<span id="cb460-2"><a href="ggplot2-package.html#cb460-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</details>
<p><strong>5- Add a column to the data frame “project1” (call this column “expr_limits”), that will be filled the following way:</strong></p>
<ul>
<li>if the expression of a gene is &gt; 13 in both sampleB and sampleH, set to the value in “expr_limits” to “high”</li>
<li>if the expression of a gene is &lt; 6 in both sampleB and sampleH, set it to “low”</li>
<li>if different, set it to “normal.”</li>
</ul>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="ggplot2-package.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize all values to &quot;normal&quot;</span></span>
<span id="cb461-2"><a href="ggplot2-package.html#cb461-2" aria-hidden="true" tabindex="-1"></a>project1<span class="sc">$</span>expr_limits <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb461-3"><a href="ggplot2-package.html#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;high&quot; if project1$sampleB &gt; 13 and project1$sampleH &gt; 13</span></span>
<span id="cb461-4"><a href="ggplot2-package.html#cb461-4" aria-hidden="true" tabindex="-1"></a>project1<span class="sc">$</span>expr_limits[project1<span class="sc">$</span>sampleB <span class="sc">&gt;</span> <span class="dv">13</span> <span class="sc">&amp;</span> project1<span class="sc">$</span>sampleH <span class="sc">&gt;</span> <span class="dv">13</span>] <span class="ot">&lt;-</span> <span class="st">&quot;high&quot;</span></span>
<span id="cb461-5"><a href="ggplot2-package.html#cb461-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;low&quot; if project1$sampleB &lt; 6 and project1$sampleH &lt; 6</span></span>
<span id="cb461-6"><a href="ggplot2-package.html#cb461-6" aria-hidden="true" tabindex="-1"></a>project1<span class="sc">$</span>expr_limits[project1<span class="sc">$</span>sampleB <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> project1<span class="sc">$</span>sampleH <span class="sc">&lt;</span> <span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">&quot;low&quot;</span></span>
<span id="cb461-7"><a href="ggplot2-package.html#cb461-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-8"><a href="ggplot2-package.html#cb461-8" aria-hidden="true" tabindex="-1"></a><span class="do">## more complicated version, using a for loop and if statement</span></span>
<span id="cb461-9"><a href="ggplot2-package.html#cb461-9" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize column &quot;expr_limits&quot; with &quot;normal&quot;</span></span>
<span id="cb461-10"><a href="ggplot2-package.html#cb461-10" aria-hidden="true" tabindex="-1"></a>project1<span class="sc">$</span>expr_limits <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb461-11"><a href="ggplot2-package.html#cb461-11" aria-hidden="true" tabindex="-1"></a><span class="co"># loop around each row of &quot;project1&quot;</span></span>
<span id="cb461-12"><a href="ggplot2-package.html#cb461-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(project1)){</span>
<span id="cb461-13"><a href="ggplot2-package.html#cb461-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create an object that contains only row &quot;i&quot; (the row will be different at every iteration)</span></span>
<span id="cb461-14"><a href="ggplot2-package.html#cb461-14" aria-hidden="true" tabindex="-1"></a>  rowi <span class="ot">&lt;-</span> project1[i,]</span>
<span id="cb461-15"><a href="ggplot2-package.html#cb461-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test values in rowi: assign expr_limits accordingly</span></span>
<span id="cb461-16"><a href="ggplot2-package.html#cb461-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(rowi<span class="sc">$</span>sampleB <span class="sc">&gt;</span> <span class="dv">13</span> <span class="sc">&amp;</span> rowi<span class="sc">$</span>sampleH <span class="sc">&gt;</span> <span class="dv">13</span>){</span>
<span id="cb461-17"><a href="ggplot2-package.html#cb461-17" aria-hidden="true" tabindex="-1"></a>    project1<span class="sc">$</span>expr_limits[i] <span class="ot">&lt;-</span> <span class="st">&quot;high&quot;</span></span>
<span id="cb461-18"><a href="ggplot2-package.html#cb461-18" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(rowi<span class="sc">$</span>sampleB <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> rowi<span class="sc">$</span>sampleH <span class="sc">&lt;</span> <span class="dv">6</span>){</span>
<span id="cb461-19"><a href="ggplot2-package.html#cb461-19" aria-hidden="true" tabindex="-1"></a>    project1<span class="sc">$</span>expr_limits[i] <span class="ot">&lt;-</span> <span class="st">&quot;low&quot;</span></span>
<span id="cb461-20"><a href="ggplot2-package.html#cb461-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb461-21"><a href="ggplot2-package.html#cb461-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p><strong>6- Color the points of the scatter plot according to the newly created column “expr_limits.” Save that plot in the object “p”</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="ggplot2-package.html#cb462-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>project1, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>sampleB, <span class="at">y=</span>sampleH, <span class="at">color=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb462-2"><a href="ggplot2-package.html#cb462-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</details>
<p><strong>7- Add a layer to “p” in order to change the points colors to blue (for low), grey (for normal) and red (for high). Save this plot in the object “p2.”</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="ggplot2-package.html#cb463-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;grey&quot;</span>))</span></code></pre></div>
</details>
<p><strong>8- Save p2 in a jpeg file.</strong>
a. Try with RStudio Plots window (Export)<br>
b. Try in the console:<br></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="ggplot2-package.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="st">&quot;myscatterggplot.jpg&quot;</span>)</span>
<span id="cb464-2"><a href="ggplot2-package.html#cb464-2" aria-hidden="true" tabindex="-1"></a>  p2</span>
<span id="cb464-3"><a href="ggplot2-package.html#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</details>
</div>
<div id="exercise-12b--box-plot" class="section level3" number="19.9.2">
<h3><span class="header-section-number">19.9.2</span> Exercise 12b- Box plot</h3>
<p><strong>1- Convert “project1” from a wide format to a long format: save in the object “project_long”</strong>
<em>Note: remember melt function from reshape2 package.</em></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="ggplot2-package.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb465-2"><a href="ggplot2-package.html#cb465-2" aria-hidden="true" tabindex="-1"></a>project_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="at">data=</span>project1)</span></code></pre></div>
</details>
<p><strong>2- Produce a boxplot of the expression of all samples (i.e. each sample is represented by a box)</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="ggplot2-package.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb466-2"><a href="ggplot2-package.html#cb466-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
</details>
<p><strong>3- Modify the previous boxplot so as to obtain 3 “sub-boxplots” per sample, each representing the expression of either “low,” “normal” or “high” genes.</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="ggplot2-package.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">color=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb467-2"><a href="ggplot2-package.html#cb467-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
</details>
<p><strong>4- Rotate the x-axis labels (90 degrees angle).</strong>
<br>
This is new ! Google it !!</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="ggplot2-package.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">color=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb468-2"><a href="ggplot2-package.html#cb468-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb468-3"><a href="ggplot2-package.html#cb468-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code></pre></div>
</details>
<p><strong>5- Finally, add a title of your choice to the plot.</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="ggplot2-package.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">color=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb469-2"><a href="ggplot2-package.html#cb469-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb469-3"><a href="ggplot2-package.html#cb469-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb469-4"><a href="ggplot2-package.html#cb469-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;My boxplots&quot;</span>)</span></code></pre></div>
</details>
</div>
<div id="exercise-12c--bar-plot" class="section level3" number="19.9.3">
<h3><span class="header-section-number">19.9.3</span> Exercise 12c- Bar plot</h3>
<p><strong>1- Produce a bar plot of how many low/normal/high genes are in the column “expr_limits” of “project1.”</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="ggplot2-package.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project1, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb470-2"><a href="ggplot2-package.html#cb470-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
</details>
<p><strong>2- Add an horizontal line at counts 250 (y-axis). Save the plot in the object “bar”</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="ggplot2-package.html#cb471-1" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>project1, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb471-2"><a href="ggplot2-package.html#cb471-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb471-3"><a href="ggplot2-package.html#cb471-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">250</span>)</span></code></pre></div>
</details>
<p><strong>3- Swap the x and y axis. Save in object “bar2.”</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="ggplot2-package.html#cb472-1" aria-hidden="true" tabindex="-1"></a>bar2 <span class="ot">&lt;-</span> bar <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
</details>
<p><strong>4- Save “bar” and “bar2” plots in a “png” file, using the </strong>png()** function, in the console: use grid.arrange (from the gridExtra package) to organize both plots in one page !**</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="ggplot2-package.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;mybarplots.png&quot;</span>, <span class="at">width=</span><span class="dv">1000</span>)</span>
<span id="cb473-2"><a href="ggplot2-package.html#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.arrange</span>(bar, bar2, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb473-3"><a href="ggplot2-package.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</details>
</div>
<div id="exercise-12d--histogram" class="section level3" number="19.9.4">
<h3><span class="header-section-number">19.9.4</span> Exercise 12d- Histogram</h3>
<p><strong>1- Create a simple histogram using project_long (column “value”).</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="ggplot2-package.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value)) <span class="sc">+</span> </span>
<span id="cb474-2"><a href="ggplot2-package.html#cb474-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
</details>
<p><strong>2- Notice that you get the following warning message" <em>stat_bin() using <code>bins = 30</code>. Pick better value with <code>binwidth</code>.</em></strong><br>
Set “bins”" parameter of geom_histogram() to 50.</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="ggplot2-package.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value)) <span class="sc">+</span> </span>
<span id="cb475-2"><a href="ggplot2-package.html#cb475-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>)</span></code></pre></div>
</details>
<p><strong>3- The histogram plots the expression values for </strong>All samples<strong>.</strong>
<br>
Change the plot so as to obtain one histograms per sample.</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="ggplot2-package.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>variable)) <span class="sc">+</span> </span>
<span id="cb476-2"><a href="ggplot2-package.html#cb476-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>)</span></code></pre></div>
</details>
<p><strong>4- By default, geom_histogram produces a stacked histogram.</strong>
<br>
Change argument “position” to “dodge.”</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="ggplot2-package.html#cb477-1" aria-hidden="true" tabindex="-1"></a>hist1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>variable)) <span class="sc">+</span> </span>
<span id="cb477-2"><a href="ggplot2-package.html#cb477-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
</details>
<p><strong>5- A bit messy ?? Run the following:</strong></p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="ggplot2-package.html#cb478-1" aria-hidden="true" tabindex="-1"></a>hist2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>variable)) <span class="sc">+</span> </span>
<span id="cb478-2"><a href="ggplot2-package.html#cb478-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb478-3"><a href="ggplot2-package.html#cb478-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>variable)</span></code></pre></div>
<p><strong>facet_grid()</strong> is another easy way to split the views!</p>
<p><strong>6- Change the default colors with scale_fill_manual().</strong>
<br>
You can try the rainbow() function for coloring.</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="ggplot2-package.html#cb479-1" aria-hidden="true" tabindex="-1"></a>hist3 <span class="ot">&lt;-</span> hist2 <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rainbow</span>(<span class="dv">8</span>))</span></code></pre></div>
</details>
<p><strong>7- “Zoom in” the plots: set the x-axis limits from from 6 to 13.</strong>
<br>
Add the <strong>xlim()</strong> layer.</p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="ggplot2-package.html#cb480-1" aria-hidden="true" tabindex="-1"></a>hist4 <span class="ot">&lt;-</span> hist3 <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">6</span>, <span class="dv">13</span>)</span></code></pre></div>
</details>
<p><strong>8- Change the default theme to theme_minimal()</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="ggplot2-package.html#cb481-1" aria-hidden="true" tabindex="-1"></a>hist5 <span class="ot">&lt;-</span> hist4 <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<p><strong>9- Save that last plot to a file (format of your choice) with ggsave()</strong></p>
<details>
<summary>
correction
</summary>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="ggplot2-package.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span><span class="st">&quot;myhistograms.png&quot;</span>, <span class="at">plot=</span>hist5, <span class="at">device=</span><span class="st">&quot;png&quot;</span>, <span class="at">width=</span><span class="dv">20</span>)</span></code></pre></div>
</details>

</div>
</div>
<div id="more-about-the-theme-function" class="section level2" number="19.10">
<h2><span class="header-section-number">19.10</span> More about the theme() function</h2>
<p>The <strong>theme()</strong> allows a precise control of graphical parameters such as axis text, ticks and labels, or legend texts and labels, etc.
<br>
More details <a href="https://ggplot2.tidyverse.org/reference/theme.html">here</a></p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="ggplot2-package.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s the project_long object from exercise 12, and plot boxplots</span></span>
<span id="cb483-2"><a href="ggplot2-package.html#cb483-2" aria-hidden="true" tabindex="-1"></a>boxp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>project_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">color=</span>expr_limits)) <span class="sc">+</span> </span>
<span id="cb483-3"><a href="ggplot2-package.html#cb483-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb483-4"><a href="ggplot2-package.html#cb483-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb483-5"><a href="ggplot2-package.html#cb483-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the legend title:</span></span>
<span id="cb483-6"><a href="ggplot2-package.html#cb483-6" aria-hidden="true" tabindex="-1"></a>boxp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-379-1.png" width="672" /></p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="ggplot2-package.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change font of legend text</span></span>
<span id="cb484-2"><a href="ggplot2-package.html#cb484-2" aria-hidden="true" tabindex="-1"></a>boxp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>(), </span>
<span id="cb484-3"><a href="ggplot2-package.html#cb484-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-379-2.png" width="672" /></p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="ggplot2-package.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put legend on the top of the plot</span></span>
<span id="cb485-2"><a href="ggplot2-package.html#cb485-2" aria-hidden="true" tabindex="-1"></a>boxp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>(), </span>
<span id="cb485-3"><a href="ggplot2-package.html#cb485-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb485-4"><a href="ggplot2-package.html#cb485-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-379-3.png" width="672" /></p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="ggplot2-package.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate x-axis labels</span></span>
<span id="cb486-2"><a href="ggplot2-package.html#cb486-2" aria-hidden="true" tabindex="-1"></a>boxp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>(), </span>
<span id="cb486-3"><a href="ggplot2-package.html#cb486-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb486-4"><a href="ggplot2-package.html#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>,</span>
<span id="cb486-5"><a href="ggplot2-package.html#cb486-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-379-4.png" width="672" /></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="ggplot2-package.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a color to the plot&#39;s background</span></span>
<span id="cb487-2"><a href="ggplot2-package.html#cb487-2" aria-hidden="true" tabindex="-1"></a>boxp <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>(), </span>
<span id="cb487-3"><a href="ggplot2-package.html#cb487-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb487-4"><a href="ggplot2-package.html#cb487-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>,</span>
<span id="cb487-5"><a href="ggplot2-package.html#cb487-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb487-6"><a href="ggplot2-package.html#cb487-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;yellow&quot;</span>))</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-379-5.png" width="672" /></p>
</div>
<div id="volcano-plots" class="section level2" number="19.11">
<h2><span class="header-section-number">19.11</span> Volcano plots</h2>
<p>A volcano plot is a type of scatter plot represents differential expression of features (genes for example): on the x-axis we typically find the fold change and on the y-axis the p-value.
<br></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="ggplot2-package.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the data we will use for plotting</span></span>
<span id="cb488-2"><a href="ggplot2-package.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://raw.githubusercontent.com/biocorecrg/CRG_RIntroduction/master/de_df_for_volcano.rds&quot;</span>, <span class="st">&quot;de_df_for_volcano.rds&quot;</span>, <span class="at">method=</span><span class="st">&quot;curl&quot;</span>)</span>
<span id="cb488-3"><a href="ggplot2-package.html#cb488-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-4"><a href="ggplot2-package.html#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The RDS format is used to save a single R object to a file, and to restore it.</span></span>
<span id="cb488-5"><a href="ggplot2-package.html#cb488-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract that object in the current session:</span></span>
<span id="cb488-6"><a href="ggplot2-package.html#cb488-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;de_df_for_volcano.rds&quot;</span>)</span>
<span id="cb488-7"><a href="ggplot2-package.html#cb488-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-8"><a href="ggplot2-package.html#cb488-8" aria-hidden="true" tabindex="-1"></a><span class="co"># remove rows that contain NA values</span></span>
<span id="cb488-9"><a href="ggplot2-package.html#cb488-9" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> tmp[<span class="fu">complete.cases</span>(tmp), ]</span></code></pre></div>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="ggplot2-package.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The basic scatter plot: x is &quot;log2FoldChange&quot;, y is &quot;pvalue&quot;</span></span>
<span id="cb489-2"><a href="ggplot2-package.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span>pvalue)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-381-1.png" width="672" /></p>
<p>Doesn’t look quite like a Volcano plot…<br>
Convert the p-value into a -log10(p-value)</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="ggplot2-package.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert directly in the aes()</span></span>
<span id="cb490-2"><a href="ggplot2-package.html#cb490-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue))) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="ggplot2-package.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add more simple &quot;theme&quot;</span></span>
<span id="cb491-2"><a href="ggplot2-package.html#cb491-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue))) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="ggplot2-package.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertical lines for log2FoldChange thresholds, and one horizontal line for the p-value threshold </span></span>
<span id="cb492-2"><a href="ggplot2-package.html#cb492-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb492-3"><a href="ggplot2-package.html#cb492-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="ggplot2-package.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The significantly differentially expressed genes are the ones found in the upper-left and upper-right corners.</span></span>
<span id="cb493-2"><a href="ggplot2-package.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column to the data frame to specify if they are UP- or DOWN- regulated (log2FoldChange respectively positive or negative)</span></span>
<span id="cb493-3"><a href="ggplot2-package.html#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="ggplot2-package.html#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add a column of NAs</span></span>
<span id="cb493-5"><a href="ggplot2-package.html#cb493-5" aria-hidden="true" tabindex="-1"></a>de<span class="sc">$</span>diffexpressed <span class="ot">&lt;-</span> <span class="st">&quot;NO&quot;</span></span>
<span id="cb493-6"><a href="ggplot2-package.html#cb493-6" aria-hidden="true" tabindex="-1"></a><span class="co"># if log2Foldchange &gt; 0.6 and pvalue &lt; 0.05, set as &quot;UP&quot; </span></span>
<span id="cb493-7"><a href="ggplot2-package.html#cb493-7" aria-hidden="true" tabindex="-1"></a>de<span class="sc">$</span>diffexpressed[de<span class="sc">$</span>log2FoldChange <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> de<span class="sc">$</span>pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="st">&quot;UP&quot;</span></span>
<span id="cb493-8"><a href="ggplot2-package.html#cb493-8" aria-hidden="true" tabindex="-1"></a><span class="co"># if log2Foldchange &lt; -0.6 and pvalue &lt; 0.05, set as &quot;DOWN&quot;</span></span>
<span id="cb493-9"><a href="ggplot2-package.html#cb493-9" aria-hidden="true" tabindex="-1"></a>de<span class="sc">$</span>diffexpressed[de<span class="sc">$</span>log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">&amp;</span> de<span class="sc">$</span>pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DOWN&quot;</span></span>
<span id="cb493-10"><a href="ggplot2-package.html#cb493-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-11"><a href="ggplot2-package.html#cb493-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-plot but this time color the points with &quot;diffexpressed&quot;</span></span>
<span id="cb493-12"><a href="ggplot2-package.html#cb493-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue), <span class="at">col=</span>diffexpressed)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb493-13"><a href="ggplot2-package.html#cb493-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-14"><a href="ggplot2-package.html#cb493-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add lines as before...</span></span>
<span id="cb493-15"><a href="ggplot2-package.html#cb493-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb493-16"><a href="ggplot2-package.html#cb493-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="ggplot2-package.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Change point color </span></span>
<span id="cb494-2"><a href="ggplot2-package.html#cb494-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-3"><a href="ggplot2-package.html#cb494-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. by default, it is assigned to the categories in an alphabetical order):</span></span>
<span id="cb494-4"><a href="ggplot2-package.html#cb494-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb494-5"><a href="ggplot2-package.html#cb494-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-6"><a href="ggplot2-package.html#cb494-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. to automate a bit: ceate a named vector: the values are the colors to be used, the names are the categories they will be assigned to:</span></span>
<span id="cb494-7"><a href="ggplot2-package.html#cb494-7" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb494-8"><a href="ggplot2-package.html#cb494-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mycolors) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DOWN&quot;</span>, <span class="st">&quot;UP&quot;</span>, <span class="st">&quot;NO&quot;</span>)</span>
<span id="cb494-9"><a href="ggplot2-package.html#cb494-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> mycolors)</span></code></pre></div>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="ggplot2-package.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now write down the name of genes beside the points...</span></span>
<span id="cb495-2"><a href="ggplot2-package.html#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column &quot;delabel&quot; to de, that will contain the name of genes differentially expressed (NA in case they are not)</span></span>
<span id="cb495-3"><a href="ggplot2-package.html#cb495-3" aria-hidden="true" tabindex="-1"></a>de<span class="sc">$</span>delabel <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb495-4"><a href="ggplot2-package.html#cb495-4" aria-hidden="true" tabindex="-1"></a>de<span class="sc">$</span>delabel[de<span class="sc">$</span>diffexpressed <span class="sc">!=</span> <span class="st">&quot;NO&quot;</span>] <span class="ot">&lt;-</span> de<span class="sc">$</span>gene_symbol[de<span class="sc">$</span>diffexpressed <span class="sc">!=</span> <span class="st">&quot;NO&quot;</span>]</span>
<span id="cb495-5"><a href="ggplot2-package.html#cb495-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-6"><a href="ggplot2-package.html#cb495-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue), <span class="at">col=</span>diffexpressed, <span class="at">label=</span>delabel)) <span class="sc">+</span> </span>
<span id="cb495-7"><a href="ggplot2-package.html#cb495-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb495-8"><a href="ggplot2-package.html#cb495-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb495-9"><a href="ggplot2-package.html#cb495-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>()</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="ggplot2-package.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we can organize the labels nicely using the &quot;ggrepel&quot; package and the geom_text_repel() function</span></span>
<span id="cb496-2"><a href="ggplot2-package.html#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load library</span></span>
<span id="cb496-3"><a href="ggplot2-package.html#cb496-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb496-4"><a href="ggplot2-package.html#cb496-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot adding up all layers we have seen so far</span></span>
<span id="cb496-5"><a href="ggplot2-package.html#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>de, <span class="fu">aes</span>(<span class="at">x=</span>log2FoldChange, <span class="at">y=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue), <span class="at">col=</span>diffexpressed, <span class="at">label=</span>delabel)) <span class="sc">+</span></span>
<span id="cb496-6"><a href="ggplot2-package.html#cb496-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb496-7"><a href="ggplot2-package.html#cb496-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb496-8"><a href="ggplot2-package.html#cb496-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb496-9"><a href="ggplot2-package.html#cb496-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb496-10"><a href="ggplot2-package.html#cb496-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb496-11"><a href="ggplot2-package.html#cb496-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="r-intro-crg_files/figure-html/unnamed-chunk-388-1.png" width="672" /></p>

</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="plots-from-other-packages.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-intro-crg.pdf", "r-intro-crg.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
